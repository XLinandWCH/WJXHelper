<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>问卷星助手使用说明</title>
    <style>
        body { font-family: "Microsoft YaHei", "Segoe UI", "Helvetica Neue", Arial, sans-serif; line-height: 1.7; padding: 20px; color: #333; /* 移除了 background-color: #f9f9f9; */ }
        h1, h2, h3 { color: #2c3e50; }
        h1 { text-align: center; margin-bottom: 20px; font-size: 2em; }
        h2 { border-bottom: 2px solid #3498db; padding-bottom: 8px; margin-top: 30px; font-size: 1.5em;}
        h3 { color: #2980b9; margin-top: 20px; font-size: 1.2em;}
        p, li { margin-bottom: 10px; font-size: 1em; }
        ul, ol { margin-left: 25px; padding-left: 0; }
        code { background-color: #e9e9e9; padding: 3px 6px; border-radius: 4px; font-family: Consolas, "Courier New", monospace; color: #c7254e; }
        .important { color: #e74c3c; font-weight: bold; }
        .tip { background-color: #e8f4fd; border-left: 4px solid #3498db; padding: 10px; margin-bottom: 15px; }
        .note { background-color: #fdf5e6; border-left: 4px solid #f39c12; padding: 10px; margin-bottom: 15px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; margin-bottom: 15px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #ecf0f1; color: #2c3e50; }
    </style>
</head>
<body>
    <h1>问卷星助手 使用说明</h1>

    <p class="tip">欢迎使用 问卷星助手！本工具旨在帮助您更高效地处理问卷星的问卷填写任务。请仔细阅读以下说明以充分利用各项功能。</p>

    <h2>一、程序主界面与导航</h2>
    <p>程序界面主要分为几个区域：</p>
    <ul>
        <li><b>顶部导航栏：</b>用于切换不同的功能面板，包括“问卷配置”、“开始运行”、“程序设置”和“使用帮助”。</li>
        <li><b>内容显示区：</b>根据导航栏的选择，显示对应功能面板的内容。</li>
        <li><b>状态栏：</b>位于程序底部，显示当前操作状态或提示信息。</li>
    </ul>

    <h2>二、核心功能步骤</h2>

    <h3>1. 程序设置 (顶部导航栏)</h3>
    <p>在开始填写问卷前，建议先配置好程序的基本参数。这些设置会影响问卷解析和填写的行为。</p>
    <ul>
        <li>
            <b>浏览器类型：</b>选择您希望使用的浏览器内核。目前支持：
            <ul>
                <li>微软 Edge (<code>msedgedriver.exe</code>)</li>
                <li>谷歌 Chrome (<code>chromedriver.exe</code>)</li>
                <li>火狐 Firefox (<code>geckodriver.exe</code>)</li>
            </ul>
            请确保您的电脑已安装相应浏览器，并且对应版本的浏览器驱动程序已准备就绪。
        </li>
        <li><b>驱动路径：</b>如果所选浏览器的驱动程序不在系统环境变量 <code>PATH</code> 中，或者您希望使用特定版本的驱动，请在此处指定驱动程序文件（例如 <code>msedgedriver.exe</code>, <code>chromedriver.exe</code>, <code>geckodriver.exe</code>）的完整路径。如果留空，程序会尝试从系统PATH中查找。</li>
        <li><b>代理设置：</b>如果您需要通过代理服务器访问问卷星网站，请在此填写代理服务器的地址和端口，格式为 <code>ip地址:端口号</code> (例如 <code>127.0.0.1:7890</code>)。如果不需要代理，请留空。</li>
        <li><b>并行线程数：</b>设置同时运行的浏览器实例数量。较高的线程数可以加快填写速度，但也更消耗系统资源。请根据您的电脑配置和网络情况酌情设置。</li>
        <li><b>目标填写总份数：</b>设定本次任务计划填写的问卷总数量。</li>
        <li><b>无头模式：</b>
            <ul>
                <li>勾选此项，浏览器将在后台静默运行，不显示实际的浏览器窗口界面。这可以减少资源消耗并避免干扰，推荐在正式批量填写时使用。</li>
                <li>取消勾选，浏览器窗口将会显示出来，方便调试或观察填写过程。</li>
            </ul>
        </li>
        <li><b>界面主题：</b>程序提供了多种界面颜色主题供您选择，包括：
            <ul>
                <li>灰粉玫瑰</li>
                <li>薄雾蓝空</li>
                <li>暖意灰调</li>
                <li>经典默认</li>
            </ul>
            选择喜欢的主题后，程序会自动保存您的偏好，并在下次启动时应用。
        </li>
        <li><b>临时用户数据目录基础路径：</b>（高级设置）指定一个目录，程序会在其下为每个并发的浏览器实例创建独立的临时用户配置文件目录。这有助于隔离不同填写实例的Cookies和缓存，提高稳定性。如果留空，程序会默认使用系统临时文件夹下的特定子目录。</li>
    </ul>

    <h3>2. 问卷配置 (顶部导航栏)</h3>
    <p>这是配置问卷答案策略的核心步骤。</p>
    <ol>
        <li><b>输入问卷URL：</b>将您需要填写的问卷星问卷的完整链接粘贴到“问卷URL”输入框中 (例如: <code>https://www.wjx.cn/vm/xxxx.aspx</code>)。</li>
        <li><b>加载问卷：</b>点击“加载问卷”按钮。程序会启动一个浏览器实例（根据您的“程序设置”）在后台访问并解析该问卷的结构。此过程可能需要一些时间，请耐心等待状态栏或界面提示解析完成。</li>
        <li>
            <b>配置答案权重与内容：</b>问卷解析成功后，所有题目及其选项会显示在下方区域。您需要为不同类型的题目配置相应的答案生成策略：
            <ul>
                <li><b>单选题 / 量表题 / 下拉选择题：</b>为每个选项输入一个非负整数作为“权重值”。权重值用英文逗号 <code>,</code> 隔开。程序会根据权重比例随机选择一个答案。例如，配置为 <code>30,70,0</code>，则第二个选项被选中的概率约等于70%，第三个选项不会被选中。如果所有权重都为0，则会随机选择一个。</li>
                <li><b>多选题：</b>为每个选项输入一个0到100之间的整数，代表该选项被选中的“百分比概率”。概率值用英文逗号 <code>,</code> 隔开。例如，配置为 <code>100,50,0</code>，则第一个选项必定被选中，第二个选项有50%的概率被选中，第三个选项不会被选中。</li>
                <li><b>填空题：</b>
                    <ul>
                        <li>直接输入您希望填写的固定文本内容。</li>
                        <li>如果您希望提供多个备选答案供程序随机选择其一进行填写，请使用双竖线 <code>||</code>作为分隔符。例如：<code>张三||李四||王五</code>，程序每次填写时会从这三个名字中随机选择一个。</li>
                    </ul>
                </li>
                <li><b>滑块题：</b>
                    <ul>
                        <li>输入一个具体的数值（通常是1到100之间的整数），程序将尝试将滑块设置到该值。</li>
                        <li>或者，您可以使用 <code>值1,值2:权重1,权重2</code> 的格式来设置多个候选值及其对应的选择权重。例如 <code>60,80:1,1</code> 表示有等同概率选择60或80。</li>
                    </ul>
                </li>
                <li><b>排序题：</b>程序会自动对可排序项进行完全随机的排序，通常无需额外配置。</li>
                <li><b>矩阵题：</b>矩阵题的每个子问题（每一行）相当于一个单选题。请为该行对应的各个选项（每一列）设置权重值，规则同单选题。</li>
                <li><b>其他项文本：</b>对于单选题或多选题中的“其他（请注明）”这类选项，如果解析器能够识别，会在其下方提供一个额外的输入框，您可以配置当选中此“其他”项时需要填写的具体文本。同样支持使用 <code>||</code> 分隔多个备选文本。</li>
            </ul>
        </li>
        <li><b>保存配置 (新增功能)：</b>
            <p>当您完成对当前问卷所有题目的答案配置后，可以点击界面下方的【保存配置】按钮。程序会将您为每个题目设置的权重、概率、填空内容（包括“其他”项的文本）等所有配置信息，保存到一个JSON格式的文件中。您可以自定义文件名和保存位置。</p>
            <p class="tip">这个功能非常适合当您需要重复填写同一份问卷，或者需要为一份长问卷预设多种不同的答案策略时使用。避免了每次关闭程序后重新配置的繁琐。</p>
        </li>
        <li><b>导入配置 (新增功能)：</b>
            <p>在您通过“加载问卷”成功解析并显示出问卷题目后，可以点击界面下方的【导入配置】按钮。然后选择一个之前通过【保存配置】功能创建的JSON文件。</p>
            <p class="tip">程序会读取该JSON文件中的配置信息，并自动将这些配置应用到当前界面上显示的对应题目中。如果JSON文件中的某些题目ID在当前加载的问卷中不存在，则会跳过这些题目的配置。导入完成后会有提示。</p>
        </li>
    </ol>

    <h3>3. 开始运行 (顶部导航栏)</h3>
    <p>完成所有配置后，即可开始自动化填写流程。</p>
    <ol>
        <li>点击顶部导航栏的“开始运行”切换到运行控制面板。</li>
        <li>程序会自动使用您在“问卷配置”面板最后加载和配置的问卷数据及URL。</li>
        <li><b>启动任务：</b>点击“开始全部填写”按钮，程序会根据“程序设置”中的并行线程数和目标填写总份数启动填写任务。</li>
        <li><b>监控进度：</b>
            <ul>
                <li><b>整体进度：</b>显示总的已完成份数、目标份数和成功率。</li>
                <li><b>线程状态：</b>每个线程会独立显示其当前状态（如：初始化、填写中、遇到验证码、成功、失败等）、已完成份数和详细的操作日志。</li>
                <li><b>日志信息：</b>主日志区域会汇总所有线程的关键信息和错误报告。</li>
            </ul>
        </li>
        <li><b>控制操作：</b>
            <ul>
                <li><b>暂停全部：</b>临时挂起所有正在运行的填写线程。</li>
                <li><b>继续全部：</b>恢复所有已暂停的线程。</li>
                <li><b>停止全部：</b>立即终止所有填写任务。请注意，强制停止可能导致部分已打开的浏览器未能正常关闭。</li>
            </ul>
        </li>
    </ol>

    <h2>三、常见问题与注意事项</h2>
    <ul>
        <li><span class="important">驱动程序：</span>确保您选择的浏览器类型有对应的、版本匹配的驱动程序，并且路径设置正确或已添加到系统环境变量。驱动问题是导致程序无法启动浏览器的最常见原因。</li>
        <li><span class="important">网络连接：</span>自动化填写过程需要稳定的网络连接。</li>
        <li><b>人机验证：</b>对于问卷星中出现的复杂人机验证（如图形点选、识字、高级滑块等），本工具目前的自动处理能力有限。如果频繁遇到无法通过的验证，可能需要减少线程数、增加操作间的随机延时（程序内部已有一定延时），或者在非无头模式下观察并手动辅助。</li>
        <li><b>问卷结构变化：</b>如果问卷发布者修改了问卷的题目顺序、类型或ID，之前保存的配置可能无法完全正确应用，需要重新检查和调整。</li>
        <li><b>软件更新：</b>请留意“使用帮助”面板中的更新检查功能，及时获取最新版本的软件以获得更好的兼容性和新功能。</li>
        <li><span class="important">合法合规：</span>请合理使用本工具，并严格遵守问卷星平台的用户协议以及国家相关法律法规。任何滥用行为及其后果由使用者自行承担。</li>
    </ul>

    <p class="note">如果您在使用过程中遇到任何问题或有功能建议，欢迎通过项目主页的渠道反馈。祝您使用愉快！</p>

</body>
</html>